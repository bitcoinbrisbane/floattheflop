!function(e){"use strict";let t={data:{},limit:1/0,onAutocomplete:null,minLength:1,sortFunction:function(e,t,n){return e.indexOf(n)-t.indexOf(n)}};class n extends Component{constructor(t,i){super(n,t,i),this.el.M_Autocomplete=this,this.options=e.extend({},n.defaults,i),this.isOpen=!1,this.count=0,this.activeIndex=-1,this.oldVal,this.$inputField=this.$el.closest(".input-field"),this.$active=e(),this._mousedown=!1,this._setupDropdown(),this._setupEventHandlers()}static get defaults(){return t}static init(e,t){return super.init(this,e,t)}static getInstance(e){return(e.jquery?e[0]:e).M_Autocomplete}destroy(){this._removeEventHandlers(),this._removeDropdown(),this.el.M_Autocomplete=void 0}_setupEventHandlers(){this._handleInputBlurBound=this._handleInputBlur.bind(this),this._handleInputKeyupAndFocusBound=this._handleInputKeyupAndFocus.bind(this),this._handleInputKeydownBound=this._handleInputKeydown.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),this._handleContainerMousedownAndTouchstartBound=this._handleContainerMousedownAndTouchstart.bind(this),this._handleContainerMouseupAndTouchendBound=this._handleContainerMouseupAndTouchend.bind(this),this.el.addEventListener("blur",this._handleInputBlurBound),this.el.addEventListener("keyup",this._handleInputKeyupAndFocusBound),this.el.addEventListener("focus",this._handleInputKeyupAndFocusBound),this.el.addEventListener("keydown",this._handleInputKeydownBound),this.el.addEventListener("click",this._handleInputClickBound),this.container.addEventListener("mousedown",this._handleContainerMousedownAndTouchstartBound),this.container.addEventListener("mouseup",this._handleContainerMouseupAndTouchendBound),void 0!==window.ontouchstart&&(this.container.addEventListener("touchstart",this._handleContainerMousedownAndTouchstartBound),this.container.addEventListener("touchend",this._handleContainerMouseupAndTouchendBound))}_removeEventHandlers(){this.el.removeEventListener("blur",this._handleInputBlurBound),this.el.removeEventListener("keyup",this._handleInputKeyupAndFocusBound),this.el.removeEventListener("focus",this._handleInputKeyupAndFocusBound),this.el.removeEventListener("keydown",this._handleInputKeydownBound),this.el.removeEventListener("click",this._handleInputClickBound),this.container.removeEventListener("mousedown",this._handleContainerMousedownAndTouchstartBound),this.container.removeEventListener("mouseup",this._handleContainerMouseupAndTouchendBound),void 0!==window.ontouchstart&&(this.container.removeEventListener("touchstart",this._handleContainerMousedownAndTouchstartBound),this.container.removeEventListener("touchend",this._handleContainerMouseupAndTouchendBound))}_setupDropdown(){this.container=document.createElement("ul"),this.container.id=`autocomplete-options-${M.guid()}`,e(this.container).addClass("autocomplete-content dropdown-content"),this.$inputField.append(this.container),this.el.setAttribute("data-target",this.container.id),this.dropdown=M.Dropdown.init(this.el,{autoFocus:!1,closeOnClick:!1,coverTrigger:!1,onItemClick:t=>{this.selectOption(e(t))}}),this.el.removeEventListener("click",this.dropdown._handleClickBound)}_removeDropdown(){this.container.parentNode.removeChild(this.container)}_handleInputBlur(){this._mousedown||(this.close(),this._resetAutocomplete())}_handleInputKeyupAndFocus(e){"keyup"===e.type&&(n._keydown=!1),this.count=0;let t=this.el.value.toLowerCase();13!==e.keyCode&&38!==e.keyCode&&40!==e.keyCode&&(this.oldVal===t||!M.tabPressed&&"focus"===e.type||this.open(),this.oldVal=t)}_handleInputKeydown(t){n._keydown=!0;let i,o=t.keyCode,s=e(this.container).children("li").length;o===M.keys.ENTER&&this.activeIndex>=0?(i=e(this.container).children("li").eq(this.activeIndex)).length&&(this.selectOption(i),t.preventDefault()):o!==M.keys.ARROW_UP&&o!==M.keys.ARROW_DOWN||(t.preventDefault(),o===M.keys.ARROW_UP&&this.activeIndex>0&&this.activeIndex--,o===M.keys.ARROW_DOWN&&this.activeIndex<s-1&&this.activeIndex++,this.$active.removeClass("active"),this.activeIndex>=0&&(this.$active=e(this.container).children("li").eq(this.activeIndex),this.$active.addClass("active")))}_handleInputClick(e){this.open()}_handleContainerMousedownAndTouchstart(e){this._mousedown=!0}_handleContainerMouseupAndTouchend(e){this._mousedown=!1}_highlight(e,t){let n=t.find("img"),i=t.text().toLowerCase().indexOf(""+e.toLowerCase()),o=i+e.length-1,s=t.text().slice(0,i),d=t.text().slice(i,o+1),h=t.text().slice(o+1);t.html(`<span>${s}<span class='highlight'>${d}</span>${h}</span>`),n.length&&t.prepend(n)}_resetCurrentElement(){this.activeIndex=-1,this.$active.removeClass("active")}_resetAutocomplete(){e(this.container).empty(),this._resetCurrentElement(),this.oldVal=null,this.isOpen=!1,this._mousedown=!1}selectOption(e){let t=e.text().trim();this.el.value=t,this.$el.trigger("change"),this._resetAutocomplete(),this.close(),"function"==typeof this.options.onAutocomplete&&this.options.onAutocomplete.call(this,t)}_renderDropdown(t,n){this._resetAutocomplete();let i=[];for(let e in t)if(t.hasOwnProperty(e)&&-1!==e.toLowerCase().indexOf(n)){if(this.count>=this.options.limit)break;let n={data:t[e],key:e};i.push(n),this.count++}if(this.options.sortFunction){i.sort((e,t)=>this.options.sortFunction(e.key.toLowerCase(),t.key.toLowerCase(),n.toLowerCase()))}for(let t=0;t<i.length;t++){let o=i[t],s=e("<li></li>");o.data?s.append(`<img src="${o.data}" class="right circle"><span>${o.key}</span>`):s.append("<span>"+o.key+"</span>"),e(this.container).append(s),this._highlight(n,s)}}open(){let e=this.el.value.toLowerCase();this._resetAutocomplete(),e.length>=this.options.minLength&&(this.isOpen=!0,this._renderDropdown(this.options.data,e)),this.dropdown.isOpen?this.dropdown.recalculateDimensions():this.dropdown.open()}close(){this.dropdown.close()}updateData(e){let t=this.el.value.toLowerCase();this.options.data=e,this.isOpen&&this._renderDropdown(e,t)}}n._keydown=!1,M.Autocomplete=n,M.jQueryLoaded&&M.initializeJqueryWrapper(n,"autocomplete","M_Autocomplete")}(cash);