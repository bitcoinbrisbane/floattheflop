!function(e){"use strict";let t={classes:"",dropdownOptions:{}};class i extends Component{constructor(t,s){super(i,t,s),this.$el.hasClass("browser-default")||(this.el.M_FormSelect=this,this.options=e.extend({},i.defaults,s),this.isMultiple=this.$el.prop("multiple"),this.el.tabIndex=-1,this._keysSelected={},this._valueDict={},this._setupDropdown(),this._setupEventHandlers())}static get defaults(){return t}static init(e,t){return super.init(this,e,t)}static getInstance(e){return(e.jquery?e[0]:e).M_FormSelect}destroy(){this._removeEventHandlers(),this._removeDropdown(),this.el.M_FormSelect=void 0}_setupEventHandlers(){this._handleSelectChangeBound=this._handleSelectChange.bind(this),this._handleOptionClickBound=this._handleOptionClick.bind(this),this._handleInputClickBound=this._handleInputClick.bind(this),e(this.dropdownOptions).find("li:not(.optgroup)").each(e=>{e.addEventListener("click",this._handleOptionClickBound)}),this.el.addEventListener("change",this._handleSelectChangeBound),this.input.addEventListener("click",this._handleInputClickBound)}_removeEventHandlers(){e(this.dropdownOptions).find("li:not(.optgroup)").each(e=>{e.removeEventListener("click",this._handleOptionClickBound)}),this.el.removeEventListener("change",this._handleSelectChangeBound),this.input.removeEventListener("click",this._handleInputClickBound)}_handleSelectChange(e){this._setValueToInput()}_handleOptionClick(t){t.preventDefault();let i=e(t.target).closest("li")[0],s=i.id;if(!e(i).hasClass("disabled")&&!e(i).hasClass("optgroup")&&s.length){let t=!0;if(this.isMultiple){let i=e(this.dropdownOptions).find("li.disabled.selected");i.length&&(i.removeClass("selected"),i.find('input[type="checkbox"]').prop("checked",!1),this._toggleEntryFromArray(i[0].id)),t=this._toggleEntryFromArray(s)}else e(this.dropdownOptions).find("li").removeClass("selected"),e(i).toggleClass("selected",t),this._keysSelected={},this._keysSelected[i.id]=!0;e(this._valueDict[s].el).prop("selected")!==t&&(e(this._valueDict[s].el).prop("selected",t),this.$el.trigger("change"))}t.stopPropagation()}_handleInputClick(){this.dropdown&&this.dropdown.isOpen&&(this._setValueToInput(),this._setSelectedStates())}_setupDropdown(){this.wrapper=document.createElement("div"),e(this.wrapper).addClass("select-wrapper "+this.options.classes),this.$el.before(e(this.wrapper)),this.wrapper.appendChild(this.el),this.el.disabled&&this.wrapper.classList.add("disabled"),this.$selectOptions=this.$el.children("option, optgroup"),this.dropdownOptions=document.createElement("ul"),this.dropdownOptions.id=`select-options-${M.guid()}`,e(this.dropdownOptions).addClass("dropdown-content select-dropdown "+(this.isMultiple?"multiple-select-dropdown":"")),this.$selectOptions.length&&this.$selectOptions.each(t=>{if(e(t).is("option")){let e;e=this.isMultiple?this._appendOptionWithIcon(this.$el,t,"multiple"):this._appendOptionWithIcon(this.$el,t),this._addOptionToValueDict(t,e)}else if(e(t).is("optgroup")){let i=e(t).children("option");e(this.dropdownOptions).append(e('<li class="optgroup"><span>'+t.getAttribute("label")+"</span></li>")[0]),i.each(e=>{let t=this._appendOptionWithIcon(this.$el,e,"optgroup-option");this._addOptionToValueDict(e,t)})}}),this.$el.after(this.dropdownOptions),this.input=document.createElement("input"),e(this.input).addClass("select-dropdown dropdown-trigger"),this.input.setAttribute("type","text"),this.input.setAttribute("readonly","true"),this.input.setAttribute("data-target",this.dropdownOptions.id),this.el.disabled&&e(this.input).prop("disabled","true"),this.$el.before(this.input),this._setValueToInput();let t=e('<svg class="caret" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>');if(this.$el.before(t[0]),!this.el.disabled){let t=e.extend({},this.options.dropdownOptions);t.onOpenEnd=(t=>{let i=e(this.dropdownOptions).find(".selected").first();if(i.length&&(M.keyDown=!0,this.dropdown.focusedIndex=i.index(),this.dropdown._focusFocusedItem(),M.keyDown=!1,this.dropdown.isScrollable)){let e=i[0].getBoundingClientRect().top-this.dropdownOptions.getBoundingClientRect().top;e-=this.dropdownOptions.clientHeight/2,this.dropdownOptions.scrollTop=e}}),this.isMultiple&&(t.closeOnClick=!1),this.dropdown=M.Dropdown.init(this.input,t)}this._setSelectedStates()}_addOptionToValueDict(e,t){let i=Object.keys(this._valueDict).length,s=this.dropdownOptions.id+i,n={};t.id=s,n.el=e,n.optionEl=t,this._valueDict[s]=n}_removeDropdown(){e(this.wrapper).find(".caret").remove(),e(this.input).remove(),e(this.dropdownOptions).remove(),e(this.wrapper).before(this.$el),e(this.wrapper).remove()}_appendOptionWithIcon(t,i,s){let n=i.disabled?"disabled ":"",o="optgroup-option"===s?"optgroup-option ":"",l=this.isMultiple?`<label><input type="checkbox"${n}"/><span>${i.innerHTML}</span></label>`:i.innerHTML,p=e("<li></li>"),d=e("<span></span>");d.html(l),p.addClass(`${n} ${o}`),p.append(d);let h=i.getAttribute("data-icon");if(h){let t=e(`<img alt="" src="${h}">`);p.prepend(t)}return e(this.dropdownOptions).append(p[0]),p[0]}_toggleEntryFromArray(t){let i=!this._keysSelected.hasOwnProperty(t),s=e(this._valueDict[t].optionEl);return i?this._keysSelected[t]=!0:delete this._keysSelected[t],s.toggleClass("selected",i),s.find('input[type="checkbox"]').prop("checked",i),s.prop("selected",i),i}_setValueToInput(){let t=[];if(this.$el.find("option").each(i=>{if(e(i).prop("selected")){let s=e(i).text();t.push(s)}}),!t.length){let e=this.$el.find("option:disabled").eq(0);e.length&&""===e[0].value&&t.push(e.text())}this.input.value=t.join(", ")}_setSelectedStates(){this._keysSelected={};for(let t in this._valueDict){let i=this._valueDict[t],s=e(i.el).prop("selected");e(i.optionEl).find('input[type="checkbox"]').prop("checked",s),s?(this._activateOption(e(this.dropdownOptions),e(i.optionEl)),this._keysSelected[t]=!0):e(i.optionEl).removeClass("selected")}}_activateOption(t,i){if(i){this.isMultiple||t.find("li.selected").removeClass("selected");e(i).addClass("selected")}}getSelectedValues(){let e=[];for(let t in this._keysSelected)e.push(this._valueDict[t].el.value);return e}}M.FormSelect=i,M.jQueryLoaded&&M.initializeJqueryWrapper(i,"formSelect","M_FormSelect")}(cash);