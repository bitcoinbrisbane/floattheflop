"use strict";var inst,validationAutoLoaded=!1;loadjs([generatorUrl+"generator-assets/stylesheets/generator.min.css",adminUrl+"assets/stylesheets/fa-svg-with-js.min.css",generatorUrl+"generator-assets/lib/remodal/remodal.css",generatorUrl+"generator-assets/lib/remodal/remodal-default-theme.css",adminUrl+"assets/stylesheets/qtip.min.css",adminUrl+"assets/stylesheets/ripple.min.css"]),loadjs([adminUrl+"assets/javascripts/jquery-3.2.1.min.js",adminUrl+"assets/javascripts/popper.min.js",adminUrl+"assets/javascripts/bootstrap.min.js"],"core",{async:!1}),loadjs.ready("core",(function(){loadjs([adminUrl+"assets/javascripts/plugins/ripple.min.js"],"bundleA"),loadjs([adminUrl+"assets/javascripts/plugins/jquery.qtip.min.js"],"bundleB"),loadjs([generatorUrl+"generator-assets/lib/remodal/remodal.min.js"],"bundleC"),loadjs([adminUrl+"assets/javascripts/fontawesome-all.min.js"]);var $actionInput=$('input[name="action"]'),actionValue=$actionInput.val();void 0!==actionValue&&""!==actionValue||(actionValue="build_read",$actionInput.val(actionValue)),$('#form-select-table select[name="table"]').on("change",(function(){$('input[name="table-to-reset"]').val($(this).val()),$('button[name="btn-reset-table"]').find("em").text($(this).val())})),$('input[name="list_type"]').on("change",(function(e){!0===$('input[value="build_paginated_list"]').prop("checked")?($('div[data-show-values="build_paginated_list"]').removeClass("off").addClass("on"),$('div[data-show-values="build_single_element_list"]').removeClass("on").addClass("off")):!0===$('input[value="build_single_element_list"]').prop("checked")&&($('div[data-show-values="build_paginated_list"]').removeClass("on").addClass("off"),$('div[data-show-values="build_single_element_list"]').removeClass("off").addClass("on"))})),$('input[value="build_read"]').trigger("change"),$("#reload-db-structure-link").on("click",(function(){$.ajax({url:generatorUrl+"inc/reload-db-structure.php",type:"GET"}).done((function(data){location.reload()}))})),$('button[name="form-select-fields-submit-btn"]').on("click",(function(e){e.preventDefault();var $form=$("#form-select-fields");$.when($form.find(".hidden-wrapper.off").remove()).then((function(){$form.submit()}))})),$('input[name^="rp_others_"]').on("change",(function(e){var skippable=$(this).closest("div.form-group").siblings(".skippable");"skip"===$(this).val()?skippable.slideUp():skippable.slideDown()})),$('input[name^="rp_others_"]:checked').trigger("change"),$(".card-header .close").on("click",(function(){$(this).closest(".card").remove()})),$('select[name^="rp_value_type_"]').on("change",(function(){var value=$(this).val(),$fgroup=$(this).closest(".form-group");"array"==value||"image"==value||"file"==value||"password"==value?$fgroup.find('select[name^="rp_jedit_"]').val("").trigger("change").attr("disabled",!0).closest("label").addClass("disabled"):$fgroup.find('select[name^="rp_jedit_"]').removeAttr("disabled").closest("label").removeClass("disabled")})),$('select[name^="rp_value_type_"]').trigger("change"),$('select[name^="cu_field_type_"]').on("change",(function(){var value=$(this).val(),$col=$(this).closest(".form-group").parent('div[class^="col-"]'),$date_placeholder,$widthSelect=$col.find('select[name^="cu_field_width_"]');"textarea"!=value?$col.find(".tinymce").prop("checked",!1).attr("disabled",!0).closest("label").addClass("disabled"):$col.find(".tinymce").removeAttr("disabled").closest("label").removeClass("disabled"),"image"==value?$(this).closest(".form-group").find(".cu_special_image_wrapper").show():$(this).closest(".form-group").find(".cu_special_image_wrapper").hide(),"date"==value||"datetime"==value||"time"==value||"month"==value?("date"==value||"datetime"==value||"month"==value?("date"==value||"datetime"==value?$date_placeholder="dddd mmmm yyyy":"month"==value&&($date_placeholder="mmmm"),$col.find(".cu_special_date_wrapper").find('label[for^="cu_special_date_"]').show(),$col.find(".cu_special_date_wrapper").find('input[name^="cu_special_date_"]').attr("placeholder",$date_placeholder).parent('div[class^="col-"]').show()):($col.find(".cu_special_date_wrapper").find('label[for^="cu_special_date_"]').hide(),$col.find(".cu_special_date_wrapper").find('input[name^="cu_special_date_"]').parent('div[class^="col-"]').hide()),"datetime"==value||"time"==value?($col.find(".cu_special_date_wrapper").find('label[for^="cu_special_time_"]').show(),$col.find(".cu_special_date_wrapper").find('input[name^="cu_special_time_"]').attr("placeholder","H:i a").parent('div[class^="col-"]').show()):($col.find(".cu_special_date_wrapper").find('label[for^="cu_special_time_"]').hide(),$col.find(".cu_special_date_wrapper").find('input[name^="cu_special_time_"]').parent('div[class^="col-"]').hide()),$col.find(".cu_special_date_wrapper").show()):$col.find(".cu_special_date_wrapper").hide(),"password"==value?$col.find(".cu_special_password_wrapper").show():$col.find(".cu_special_password_wrapper").hide(),"input"==value||"textarea"==value?$col.find(".char-count").removeAttr("disabled").closest("label").removeClass("disabled"):$col.find(".char-count").prop("checked",!1).attr("disabled",!0).closest("label").addClass("disabled"),"datetime"==value?$widthSelect.find('option[value^="33%"]').attr("disabled",!0):$widthSelect.find('option[value^="33%"]').removeAttr("disabled")})),$('input[name^="bulk_constrained_tables_"]')[0]&&($('input[name^="bulk_constrained_tables_"]').on("change",(function(){var cascade_delete_input_id=$(this).attr("id").replace("bulk_","");$("#"+cascade_delete_input_id).prop("checked",!0)})),$('input[name^="constrained_tables_"]').on("change",(function(){var bulk_cascade_delete_input_id="bulk_"+$(this).attr("id");$("#"+bulk_cascade_delete_input_id).prop("checked",!0)})));var validationContainers=$('[id^="validation-custom-ajax-elements-container-"]'),updateArgumentsHelper=function(){$('select[name^="cu_validation_function_"]').on("change",(function(){var index=$(this).attr("data-index"),columnName=$(this).attr("data-column-name"),target=$("#ajax-update-validation-helper");$.ajax({url:generatorUrl+"inc/update-validation-helper.php",data:{columnName:columnName,index:index,value:$(this).val()}}).done((function(data){target.html(data);var run=window.go;setTimeout(run,0)})).fail((function(data,statut,error){console.log(error)}))}))};updateArgumentsHelper();var removeDynamicValidation=function(target,btnRemove,countInput){var currentIndex=parseInt($(btnRemove).attr("data-index")),dfIndex=parseInt(countInput.val()),transferUpperValues=function(){var previousDynamic=target.find('.validation-dynamic[data-index="'+currentIndex+'"]'),previousFields=$(previousDynamic).find("input, textarea, select, radio, checkbox");$(previousFields).each((function(i,field){var followingField="",newValue="",followingFieldId=$(field).attr("id").replace("-"+parseInt(currentIndex),"-"+parseInt(currentIndex+1));followingField=$("#"+followingFieldId),$(field).is("select")?(newValue=followingField.val(),$(field).val(newValue).trigger("change")):(newValue=followingField.val(),$(field).val(newValue))}))};if(target.find(".validation-dynamic")[currentIndex])for(;target.find($(".validation-dynamic")[currentIndex]).length>0;)transferUpperValues(),currentIndex++;dfIndex-=1,countInput.val(dfIndex),target.find(".validation-remove-element-button:last").closest(".validation-dynamic").remove()};if($(validationContainers).each((function(index,value){var target=$(this),columnName=$(this).attr("id").replace("validation-custom-ajax-elements-container-",""),countInput=$('input[name="validation-dynamic-fields-index-'+columnName+'"]'),dfIndex;$(this).siblings().find(".validation-add-element-button").on("click",(function(){dfIndex=parseInt(countInput.val()),dfIndex++,countInput.val(dfIndex),$.ajax({url:generatorUrl+"inc/validation-custom-dynamic-elements.php",data:{columnName:columnName,index:dfIndex}}).done((function(data){target.append(data);var run=window.run;void 0!==run&&setTimeout(run,0),updateArgumentsHelper(),target.find(".validation-remove-element-button").removeClass("hidden").off("click").on("click",(function(){removeDynamicValidation(target,this,countInput)}))})).fail((function(data,statut,error){console.log(error)}))})),$(this).find(".validation-remove-element-button").on("click",(function(){removeDynamicValidation(target,this,countInput)}))})),$("#debug")[0]){var debug=$("#debug"),debugWidth=$("#debug").outerWidth();$("#btn-debug").on("click",(function(){debug.hasClass("on")?debug.removeClass("on").animate({left:$(window).outerWidth()},200):debug.addClass("on").animate({left:$(window).outerWidth()-debugWidth},200)}))}$("#lock-admin-link")[0]&&$("#lock-admin-link").on("click",(function(e){return e.preventDefault(),$("form#lock-unlock-admin").submit(),!1}));var $columnFields=$('select[name^="cu_field_type_"], select[name^="cu_special_password_"]');$columnFields.on("change",(function(e){if($("body").hasClass("dependent-fields-loaded")){var columnIndex=$(e.target).attr("data-index"),columnName=$(e.target).attr("id").replace("cu_field_type_","").replace("cu_special_password_",""),target=$('div[id="validation-auto-ajax-elements-container-'+columnName+'"]'),fieldType=$('select[name="cu_field_type_'+columnName+'"]').val(),passwordValue=$('select[name^="cu_special_password_'+columnName+'"]').val();$.ajax({url:generatorUrl+"inc/validation-auto-ajax-elements.php",async:!0,data:{columnName:columnName,fieldType:fieldType,passwordValue:passwordValue}}).done((function(data){target.html(data)})).fail((function(){console.log("error")}))}}));var loadValidationAuto=function(){$("body").hasClass("dependent-fields-loaded")?($columnFields.each((function(){var validation_radio=$(this).attr("name").replace("cu_field_type_","cu_validation_type_");$('input[name="'+validation_radio+'"]')[0]&&"auto"==$('input[name="'+validation_radio+'"]:checked').val()&&$(this).trigger("change")})),validationAutoLoaded=!0):setTimeout(loadValidationAuto,600)};$(".choose-action-radio").on("click",(function(){return actionValue=$(this).attr("id"),$actionInput.val(actionValue).trigger("change"),$(".choose-action-radio.active").removeClass("bg-pink-500 active").addClass("bg-dark"),$("#"+actionValue).removeClass("bg-dark").addClass("bg-pink-500 active"),"build_create_edit"==actionValue&&!1===validationAutoLoaded&&loadValidationAuto(),!1})),$("#"+actionValue).trigger("click")})),loadjs.ready(["core","bundleA"],(function(){$(".legitRipple").ripple()})),loadjs.ready(["core","bundleB"],(function(){$("[data-tooltip]").each((function(){var defaults={style:"qtip-dark",title:""};$(this).is("input")?(defaults.showEvent="focus",defaults.hideEvent="unfocus"):(defaults.showEvent="mouseenter",defaults.hideEvent="mouseleave");var options=defaults;for(var key in defaults)void 0!==$(this).data(key)?options[key]=$(this).data(key):options[key]=defaults[key];if(options.position={my:"bottom center",at:"top center",adjust:{x:0,y:0}},void 0!==$(this).data("position")){var position=$(this).data("position");"right"==position?options.position={my:"left center",at:"right center"}:"bottom"==position?options.position={my:"top center",at:"bottom center"}:"left"==position&&(options.position={my:"right center",at:"left center"})}if(void 0!==$(this).data("adjust-x")){var adjustX=$(this).data("adjust-x");options.position.adjust.x=adjustX}if(void 0!==$(this).data("adjust-y")){var adjustY=$(this).data("adjust-y");options.position.adjust.y=adjustY}options.maxWidth={},void 0!==$(this).data("max-width")&&(options.maxWidth=$(this).data("max-width")),options.maxHeight={},void 0!==$(this).data("max-height")&&(options.maxHeight=$(this).data("max-height"));var selector=$(this).data("tooltip");try{options.content=$(selector).html()}catch(error){}void 0===options.content&&(options.content={title:options.title,attr:"data-tooltip"}),$(this).qtip({content:options.content,position:options.position,show:{event:options.showEvent,effect:function(offset){$(this).fadeIn(200)}},hide:{event:options.hideEvent,delay:500,effect:function(offset){$(this).fadeOut(200)}},style:{classes:options.style},events:{show:function(event,api){$(this).css({"max-width":options.maxWidth,"max-height":options.maxHeight})}}})}))})),loadjs.ready(["core","bundleC"],(function(){$('div[data-remodal-id="modal"]')[0]&&(inst=$('div[data-remodal-id="modal"]').remodal()),$('button[name^="rp_jedit_select_modal"], button[name^="cu_select_modal"]').on("click",(function(){var column=$(this).attr("data-column"),origin=$(this).attr("data-origin");$.ajax({url:generatorUrl+"inc/select-values.php",type:"GET",data:{column:column,action:"select-table"}}).done((function(data){$("#remodal-content").html(data).find(".select2").select2(),inst.open(),$(document).off("confirmation").on("confirmation",".remodal",(function(){var selectFrom=$('input[name="select-from-'+column+'"]:checked').val(),selectFromTable="",selectFromValue="",selectFromField1="",selectFromField2="",selectCustomNames="",selectCustomValues="",selectMultiple=$('input[name="select_multiple-'+column+'"]:checked').val();"from_table"==selectFrom?(selectFromTable=$('select[name="table-'+column+'"]').val(),selectFromValue=$('select[name="value-'+column+'"]').val(),selectFromField1=$('select[name="field-1-'+column+'"]').val(),selectFromField2=$('select[name="field-2-'+column+'"]').val()):"custom_values"==selectFrom&&(selectCustomNames=$('input[name^="custom_name-"]').serializeArray(),selectCustomValues=$('input[name^="custom_value-"]').serializeArray()),$.ajax({url:generatorUrl+"inc/register-select-values.php",type:"POST",data:{column:column,origin:origin,select_from:selectFrom,select_from_table:selectFromTable,select_from_value:selectFromValue,select_from_field_1:selectFromField1,select_from_field_2:selectFromField2,select_custom_names:selectCustomNames,select_custom_values:selectCustomValues,select_multiple:selectMultiple}}).done((function(data){"rp_jedit"==origin?$("#rp_select-values-"+column).html(data):"create-edit"==origin&&$("#cu_select-values-"+column).html(data)})).fail((function(){console.log("error")}))}))})).fail((function(data,statut,error){console.log(error)}))}));var target=$("#filters-ajax-elements-container"),countInput=$('input[name="filters-dynamic-fields-index"]'),dfIndex=parseInt(countInput.val()),enableRemoveDynamic=function(){$(".filters-remove-element-button").removeClass("hidden").off("click").on("click",(function(){var currentIndex=parseInt($(this).attr("data-index")),transferUpperValues=function(){var previousDynamic=$('.filters-dynamic[data-index="'+currentIndex+'"]'),previousFields=$(previousDynamic).find("input, textarea, select, radio, checkbox");$(previousFields).each((function(i,field){if(void 0===$(field).attr("data-activates")){var followingField="",newValue="";if($(field).is('input[type="radio"]')){var followingFieldName=$(field).attr("name").replace("-"+parseInt(currentIndex),"-"+parseInt(currentIndex+1));newValue=(followingField=$('input[name="'+followingFieldName+'"]:checked')).val(),$(field).val()==newValue?$(field).prop("checked",!0):$(field).prop("checked",!1)}else{var followingFieldId=$(field).attr("id").replace("-"+parseInt(currentIndex),"-"+parseInt(currentIndex+1));followingField=$("#"+followingFieldId),$(field).is("select")?(newValue=followingField.find("option:selected").val(),$(field).val(newValue)):(newValue=followingField.val(),$(field).val(newValue))}}}))};if($(".filters-dynamic")[currentIndex])for(;$($(".filters-dynamic")[currentIndex]).length>0;)transferUpperValues(),currentIndex++;dfIndex-=1,countInput.val(dfIndex),$(".filters-remove-element-button:last").closest(".filters-dynamic").remove()}))},enableDaterangeAjaxToggle=function(){$('input[name^="filter-daterange-"]').off("change").on("change",(function(e){var index=$(e.target).attr("name").replace("filter-daterange-",""),value;$(e.target).val()>0?($('input[name="filter-ajax-'+index+'"][value=""]').prop("checked",!0),$('input[name="filter-ajax-'+index+'"]').prop("disabled",!0)):$('input[name="filter-ajax-'+index+'"]').prop("disabled",!1)})),$('input[name^="filter-mode-"]').on("change",(function(e){var index=$(e.target).attr("name").replace("filter-mode-",""),value;"advanced"===$(e.target).val()?$('input[name="filter-ajax-'+index+'"]').prop("disabled",!1):$('input[name="filter-daterange-'+index+'"]:checked').trigger("change")}))};$(".filters-add-element-button").on("click",(function(){dfIndex++,countInput.val(dfIndex),$.ajax({url:generatorUrl+"inc/filters-dynamic-elements.php",data:{index:dfIndex}}).done((function(data){target.append(data);var run=window.run;void 0!==run&&setTimeout(run,0),$(".filters-dynamic .hidden-wrapper").dependentFields(),$(".filters-dynamic").niceCheck(),$(".filters-dynamic select").select2(),enableRemoveDynamic(),enableFilterTest(),enableDaterangeAjaxToggle()})).fail((function(data,statut,error){console.log(error)}))})),enableRemoveDynamic(),enableDaterangeAjaxToggle(),$('input[name^="filter-daterange-"]').each((function(){$(this).is(":checked")&&$(this).trigger("change")}));var enableFilterTest=function(){$('button[name^="filter_test-"]')[0]&&$('button[name^="filter_test-"]').off("click").on("click",(function(){var i=$(this).val(),data={},jsonKey="test_filter_"+i;data[jsonKey]="all",$('select[name="test_filter_'+i+'"]')[0]&&(data[jsonKey]=$('select[name="test_filter_'+i+'"]').val()),data.index=i,data.filter_mode=$('input[name="filter-mode-'+i+'"]:checked').val(),data.filter_A=$('select[name="filter_field_A-'+i+'"]').val(),data.select_label=$('input[name="filter_select_label-'+i+'"]').val(),data.option_text=$('input[name="filter_option_text-'+i+'"]').val(),data.fields=$('input[name="filter_fields-'+i+'"]').val(),data.field_to_filter=$('input[name="filter_field_to_filter-'+i+'"]').val(),data.from=$('input[name="filter_from-'+i+'"]').val(),data.type=$('input[name="filter_type-'+i+'"]').val(),$.ajax({url:generatorUrl+"inc/filter-test.php",type:"POST",data:data}).done((function(data){$("#remodal-content").html(data),$('button[data-remodal-action="cancel"]').css({position:"absolute",left:"-100000px"}),inst.open(),$('#remodal-content button[name="cancel_filters"]').attr("disabled",!0),$('#remodal-content button[name="submit_filters"]').attr("disabled",!0),$(document).on("confirmation",".remodal",(function(){$('button[data-remodal-action="cancel"]').css("display","inline-block")}))})).fail((function(data,statut,error){console.log(error)}))}))};enableFilterTest(),$('button[name="btn-reset-table"]')&&$('button[name="btn-reset-table"]').on("click",(function(e){return e.preventDefault(),$.ajax({url:generatorUrl+"inc/reset-table-form.php",type:"POST",data:{table:$('input[name="table-to-reset"]').val()}}).done((function(data){$("#remodal-content").html(data),$("#remodal-content").niceCheck(),inst.open(),$('input[name="reset-data-choices"]').on("click",(function(){$('input[name="reset-data"]').val($('input[name="reset-data-choices"]:checked').val())})),$(document).on("confirmation",".remodal",(function(){$("#form_reset_table").submit()}))})).fail((function(data,statut,error){console.log(error)})),!1})),$("#remove-authentification-module")[0]&&$("#remove-authentification-module").on("click",(function(e){e.preventDefault(),$.ajax({url:generatorUrl+"inc/remove-authentification-module.php",type:"GET",data:{}}).done((function(data){$("#remodal-content").html(data),$("#form-remove-authentification-module").niceCheck(),inst.open(),$(document).off("confirmation").on("confirmation",".remodal",(function(){$("#form-remove-authentification-module").submit()}))})).fail((function(data,statut,error){console.log(error)}))}))}));